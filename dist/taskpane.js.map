{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* global Office, msal */\n\ninterface FollowupItem {\n  subject: string;\n  to: string;\n  sent: string; // ISO string\n}\n\nconst SPA_CLIENT_ID = \"a82e535e-8e90-4d9b-9765-9b8ca00769a5\";\nconst AUTHORITY = \"https://login.microsoftonline.com/fe62ff8e-1750-452e-b2ff-2d788a3db229\";\nconst GRAPH_SCOPES = [\"https://graph.microsoft.com/Mail.Read\"];\n\n// ===== MSAL setup =====\nconst msalApp = new (window as any).msal.PublicClientApplication({\n  auth: { clientId: SPA_CLIENT_ID, authority: AUTHORITY },\n  cache: { cacheLocation: \"sessionStorage\" }\n});\n\nasync function getGraphAccessToken(): Promise<string> {\n  const request = { scopes: GRAPH_SCOPES };\n  let account = msalApp.getAllAccounts()[0];\n  if (!account) {\n    const loginResult = await msalApp.loginPopup(request);\n    account = loginResult.account;\n  }\n  const silentReq = { ...request, account };\n  try {\n    const resp = await msalApp.acquireTokenSilent(silentReq);\n    return resp.accessToken;\n  } catch {\n    const resp = await msalApp.acquireTokenPopup(request);\n    return resp.accessToken;\n  }\n}\n\n// ===== Your existing UI code (trimmed to the important bits) =====\nlet currentData: FollowupItem[] = [];\n\nOffice.onReady(() => {\n  (document.getElementById(\"app-body\") as HTMLElement).style.display = \"block\";\n\n  const btn = document.getElementById(\"fetchUnreplied\") as HTMLButtonElement;\n  const tbody = document.querySelector(\"#resultsTable tbody\") as HTMLElement;\n  const emptyState = document.getElementById(\"emptyState\") as HTMLElement;\n  const errorEl = document.getElementById(\"error\") as HTMLElement;\n  const search = document.getElementById(\"search\") as HTMLInputElement;\n  const daysSel = document.getElementById(\"days\") as HTMLSelectElement;\n\n  function escapeHtml(s: string) {\n    return s.replace(/[&<>\"']/g, c => ({ \"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\" }[c]!));\n  }\n\n  function render(rows: FollowupItem[]) {\n    tbody.innerHTML = \"\";\n    if (!rows.length) { emptyState.style.display = \"block\"; return; }\n    emptyState.style.display = \"none\";\n    for (const item of rows) {\n      const tr = document.createElement(\"tr\");\n      tr.innerHTML = `\n        <td colspan=\"3\" class=\"stacked-cell\">\n          <div class=\"stacked-row\">\n            <div class=\"stacked-label\">Subject:</div>\n            <div class=\"stacked-value subject\">${escapeHtml(item.subject)}</div>\n            <div class=\"stacked-label\">To:</div>\n            <div class=\"stacked-value to\">${escapeHtml(item.to)}</div>\n            <div class=\"stacked-label\">Sent:</div>\n            <div class=\"stacked-value sent\">${new Date(item.sent).toLocaleString()}</div>\n          </div>\n        </td>`;\n      tbody.appendChild(tr);\n    }\n  }\n  function filterAndRender() {\n    const q = (search.value || \"\").toLowerCase();\n    render(currentData.filter(i => i.subject.toLowerCase().includes(q) || i.to.toLowerCase().includes(q)));\n  }\n  search.addEventListener(\"input\", filterAndRender);\n\n  btn.addEventListener(\"click\", async () => {\n    btn.disabled = true; errorEl.style.display = \"none\"; emptyState.style.display = \"none\"; tbody.innerHTML = \"\";\n    try {\n      const token = await getGraphAccessToken();\n      const days = daysSel?.value || \"30\";\n      // UPDATE THIS to your Render API base:\n      const apiBase = \"https://outlook-followups-backend.onrender.com\";\n      const resp = await fetch(`${apiBase}/unreplied?days=${encodeURIComponent(days)}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      if (!resp.ok) throw new Error(`API ${resp.status}`);\n      currentData = await resp.json();\n      filterAndRender();\n    } catch (e: any) {\n      errorEl.textContent = `Error: ${e?.message || String(e)}`;\n      errorEl.style.display = \"block\";\n    } finally {\n      btn.disabled = false;\n    }\n  });\n});\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/godot_solutions_logo.jpeg\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://alcdn.msauth.net/browser/2.38.0/js/msal-browser.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"pane\\\"> <header class=\\\"appbar\\\"> <img class=\\\"logo\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Logo\\\"/> <div class=\\\"titles\\\"> <h1>Outlook Follow-Ups</h1> <p class=\\\"subtitle\\\">Unreplied sent mail · last 30 days</p> </div> </header> <div id=\\\"app-body\\\" style=\\\"display:none\\\"> <main class=\\\"content\\\"> <div class=\\\"toolbar\\\"> <button id=\\\"fetchUnreplied\\\" class=\\\"btn primary\\\"> <span class=\\\"btn-spinner\\\" aria-hidden=\\\"true\\\"></span> <span>Fetch Unreplied</span> </button> <div class=\\\"filters\\\"> <label class=\\\"sr-only\\\" for=\\\"days\\\">Days</label> <select id=\\\"days\\\" class=\\\"select\\\"> <option value=\\\"7\\\">7 days</option> <option value=\\\"14\\\">14 days</option> <option value=\\\"30\\\" selected=\\\"selected\\\">30 days</option> <option value=\\\"60\\\">60 days</option> <option value=\\\"90\\\">90 days</option> </select> </div> </div> <div class=\\\"search\\\"> <input id=\\\"search\\\" class=\\\"input\\\" placeholder=\\\"Search subject or recipient…\\\"/> </div> <section class=\\\"table-wrap\\\"> <table id=\\\"resultsTable\\\" class=\\\"table stacked-table\\\"> <tbody></tbody> </table> <div id=\\\"emptyState\\\" class=\\\"empty\\\" style=\\\"display:none\\\"> No unreplied emails for this range. </div> <div id=\\\"error\\\" class=\\\"error\\\" style=\\\"display:none\\\"></div> </section> </main> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","_arrayLikeToArray","Array","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","GRAPH_SCOPES","msalApp","msal","PublicClientApplication","auth","clientId","authority","cache","cacheLocation","getGraphAccessToken","_getGraphAccessToken","_callee2","request","account","loginResult","silentReq","resp","_resp","_context2","scopes","getAllAccounts","loginPopup","_objectSpread","acquireTokenSilent","accessToken","acquireTokenPopup","currentData","Office","onReady","getElementById","style","display","btn","tbody","querySelector","emptyState","errorEl","search","daysSel","escapeHtml","s","filterAndRender","q","toLowerCase","rows","innerHTML","_step","_iterator","isArray","toString","slice","constructor","name","from","_unsupportedIterableToArray","_n","F","next","_createForOfIteratorHelper","item","tr","createElement","concat","subject","to","Date","sent","toLocaleString","appendChild","err","render","filter","includes","addEventListener","_callee","token","days","_t","_context","disabled","fetch","encodeURIComponent","headers","Authorization","ok","status","json","textContent","message","String","URL"],"sourceRoot":""}